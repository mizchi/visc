# visc - ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å›žå¸°ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã®ç´¹ä»‹

## ãªãœ visc ã‚’ä½œã£ãŸã‹

E2Eãƒ†ã‚¹ãƒˆã¯é‡ã„ã—å£Šã‚Œã‚„ã™ã„ã€‚ç‰¹ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°çµæžœã‚„CSSå´©ã‚Œã®æ¤œå‡ºã«ã¯å‘ã„ã¦ãªã„ã€‚

ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å›žå¸°ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã¯æ—¢ã«ã„ãã¤ã‹ã‚ã‚‹ã‘ã©ã€å¤§æŠµã¯ä»¥ä¸‹ã®å•é¡ŒãŒã‚ã‚‹ï¼š

- ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã®æ¯”è¼ƒã§èª¤æ¤œçŸ¥ãŒå¤šã„
- DOMè¦ç´ å˜ä½ã®æ¯”è¼ƒã§æ„å‘³ã®ã‚ã‚‹å¤‰æ›´ã‚’è¦‹é€ƒã™
- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒè¤‡é›‘
- CIã§å‹•ã‹ã™ã®ãŒé¢å€’

visc ã¯ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã€‚

## ã‚³ã‚¢æ©Ÿèƒ½

### ã‚»ãƒžãƒ³ãƒ†ã‚£ãƒƒã‚¯ãªãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—æ¯”è¼ƒ

DOMè¦ç´ ã‚’å€‹åˆ¥ã«æ¯”è¼ƒã™ã‚‹ã‚“ã˜ã‚ƒãªãã¦ã€æ„å‘³ã®ã‚ã‚‹ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¦æ¯”è¼ƒã™ã‚‹ã€‚

```typescript
// å¾“æ¥: å€‹åˆ¥ã®DOMè¦ç´ ã‚’æ¯”è¼ƒ
// â†’ ãƒ†ã‚­ã‚¹ãƒˆãŒ1pxå‹•ã„ãŸã ã‘ã§å·®åˆ†ã¨ã—ã¦æ¤œå‡º

// visc: ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã§æ¯”è¼ƒ
// â†’ ãƒ˜ãƒƒãƒ€ãƒ¼ã€ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãªã©æ„å‘³ã®ã‚ã‚‹å˜ä½ã§æ¯”è¼ƒ
```

### è‡ªå‹•ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

åˆå›žå®Ÿè¡Œæ™‚ã«è¤‡æ•°å›žã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã€ãã®ãƒšãƒ¼ã‚¸ã®ã€Œæºã‚Œã€ã‚’åˆ†æžã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šæœ€é©ãªé–¾å€¤ã‚’è‡ªå‹•æ±ºå®šã€‚

```bash
# åˆå›žå®Ÿè¡Œã§è‡ªå‹•çš„ã«ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
visc check

# å‡ºåŠ›ä¾‹
ðŸ”§ Analyzing home... (confidence: 95.2%)
```

### LCPå¾…æ©Ÿã¨ã‚¹ãƒžãƒ¼ãƒˆãªå¾…æ©Ÿæˆ¦ç•¥

Largest Contentful Paint (LCP) ã‚’å¾…ã¤ã“ã¨ã§ã€ãƒšãƒ¼ã‚¸ã®ä¸»è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§ç¢ºå®Ÿã«å¾…æ©Ÿã€‚

```typescript
// captureOptions ã§ç´°ã‹ãåˆ¶å¾¡å¯èƒ½
{
  waitForLCP: true,  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: true
  additionalWait: 500  // LCPå¾Œã®è¿½åŠ å¾…æ©Ÿæ™‚é–“
}
```

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ¶å¾¡

åºƒå‘Šã‚„ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ãŸã‚Šã€CSSãƒ•ã‚¡ã‚¤ãƒ«ã‚’å·®ã—æ›¿ãˆãŸã‚Šã§ãã‚‹ã€‚

```json
{
  "captureOptions": {
    "networkBlocks": ["**/gtag/**", "**/analytics/**"]
  },
  "compareOptions": {
    "overrides": {
      "**/main.css": "./test-overrides/broken.css"
    }
  }
}
```

## ä½¿ã„æ–¹

### æœ€å°æ§‹æˆ

```bash
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -g @mizchi/visc

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
cat > visc.config.json << EOF
{
  "version": "1.0",
  "viewports": {
    "desktop": {
      "name": "Desktop",
      "width": 1280,
      "height": 800
    }
  },
  "testCases": [
    {
      "id": "home",
      "url": "https://example.com"
    }
  ]
}
EOF

# å®Ÿè¡Œ
visc check
```

åˆå›žå®Ÿè¡Œã§ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’ä½œæˆã€2å›žç›®ä»¥é™ã§å·®åˆ†æ¤œå‡ºã€‚

### TUIãƒ¢ãƒ¼ãƒ‰

é€²æ—ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèªã—ãŸã„å ´åˆï¼š

```bash
visc check --tui
```

å„ã‚­ãƒ£ãƒ—ãƒãƒ£ã®çŠ¶æ…‹é·ç§»ãŒè¦‹ãˆã‚‹ï¼š
- requesting â†’ waiting-lcp â†’ extracting â†’ completed

## E2Eãƒ†ã‚¹ãƒˆã¨ã®ä½¿ã„åˆ†ã‘

E2Eãƒ†ã‚¹ãƒˆãŒå¿…è¦ãªã‚±ãƒ¼ã‚¹ï¼š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ
- ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®ç¢ºèª
- è¤‡é›‘ãªã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ã®æ¤œè¨¼

visc ãŒå‘ã„ã¦ã‚‹ã‚±ãƒ¼ã‚¹ï¼š
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚Œã®æ¤œå‡º
- CSSå¤‰æ›´ã®å½±éŸ¿ç¢ºèª
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®æ¤œè¨¼
- ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã®æœ€çµ‚ç¢ºèª

## å®Ÿè£…ã®å·¥å¤«

### ãªãœã‚»ãƒžãƒ³ãƒ†ã‚£ãƒƒã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãªã®ã‹

å˜ç´”ãªDOM diffã ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå•é¡ŒãŒã‚ã‚‹ï¼š

1. å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹IDã‚„ã‚¯ãƒ©ã‚¹åã§èª¤æ¤œçŸ¥
2. 1pxã®ã‚ºãƒ¬ã§ã‚‚å·®åˆ†ã¨ã—ã¦æ¤œå‡º
3. æ„å‘³ã®ãªã„å¤‰æ›´ï¼ˆåºƒå‘Šã®åˆ‡ã‚Šæ›¿ã‚ã‚Šãªã©ï¼‰ã‚‚æ¤œå‡º

visc ã¯è¦ç´ ã‚’æ„å‘³ã®ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã€ã“ã‚Œã‚‰ã®å•é¡Œã‚’å›žé¿ã€‚

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹

ä¸¦åˆ—å®Ÿè¡Œã«å¯¾å¿œï¼š

```bash
# 8ä¸¦åˆ—ã§å®Ÿè¡Œï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚µã‚¤ãƒˆå‘ã‘ï¼‰
visc check -p 8 --interval 0
```

å¤–éƒ¨ã‚µã‚¤ãƒˆã®å ´åˆã¯é©åˆ‡ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚’è¨­å®šï¼š

```bash
# 500msã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã§é †æ¬¡å®Ÿè¡Œ
visc check --interval 500
```

## ã¾ã¨ã‚

visc ã¯E2Eãƒ†ã‚¹ãƒˆã®ä»£æ›¿ã§ã¯ãªãã€ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«é¢ã®å“è³ªä¿è¨¼ã«ç‰¹åŒ–ã—ãŸãƒ„ãƒ¼ãƒ«ã€‚

ç‰¹å¾´ï¼š
- ã‚»ãƒžãƒ³ãƒ†ã‚£ãƒƒã‚¯ãªæ¯”è¼ƒã§èª¤æ¤œçŸ¥ã‚’å‰Šæ¸›
- è‡ªå‹•ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§é–¾å€¤èª¿æ•´ä¸è¦
- ã‚·ãƒ³ãƒ—ãƒ«ãªCLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- CI/CDã«çµ„ã¿è¾¼ã¿ã‚„ã™ã„

CSSå¤‰æ›´ã‚„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´ã®å½±éŸ¿ã‚’ç´ æ—©ãç¢ºèªã—ãŸã„æ™‚ã«ä½¿ã£ã¦ã»ã—ã„ã€‚

## ãƒªãƒ³ã‚¯

- GitHub: https://github.com/mizchi/visual-checker
- npm: https://www.npmjs.com/package/@mizchi/visc